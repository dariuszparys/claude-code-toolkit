# Task: ${TASK_NAME}

${TASK_DESCRIPTION}

## Your Task

1. **Read context files**:
   - `prd.json` - User stories for this task
   - `progress.txt` - Check **Codebase Patterns** section FIRST
   - `AGENTS.md` - Additional context and constraints

2. **Check branch**: Ensure you're on the correct branch
   ```bash
   git checkout ${BRANCH_NAME} 2>/dev/null || git checkout -b ${BRANCH_NAME}
   ```

3. **Pick next story**: Select highest priority story where `passes: false`

4. **Implement ONE story**:
   - Follow patterns from progress.txt Codebase Patterns section
   - Reference existing code as templates
   - Keep changes minimal and focused

5. **Verify**:
   ```bash
   ${BUILD_COMMAND}
   ```

6. **Commit** (if build passes):
   ```bash
   git add -A
   git commit -m "story [STORY-ID]: [Title]"
   ```

7. **Update prd.json**: Set `passes: true` for completed story

8. **Append to progress.txt**:
   ```markdown
   ## [Date] - [Story ID]
   - What was implemented
   - Files changed: [list]
   - **Learnings:**
     - Any patterns discovered
     - Gotchas encountered
   ---
   ```

   If you discovered important patterns or gotchas, also add them to the **Codebase Patterns** section at the top of progress.txt so future iterations can benefit.

## Constraints

${CONSTRAINTS}

## Key Patterns from Codebase

${CODEBASE_PATTERNS}

## Critical Rules

1. **One story per iteration** - Complete exactly one story, then stop
2. **Read progress.txt first** - Check Codebase Patterns for learnings from previous iterations
3. **Capture learnings** - Always document patterns and gotchas discovered
4. **Verify before committing** - Never commit broken code
5. **Update tracking files** - Always update prd.json and progress.txt
6. **Follow existing patterns** - Match the codebase style
7. **Respect constraints** - Never violate the listed constraints

## Files Reference

- `prd.json` - User stories and acceptance criteria
- `progress.txt` - Current iteration tracking and accumulated learnings
- `AGENTS.md` - Additional context and gotchas

## Stop Condition

If **ALL stories** in prd.json have `passes: true`, output:

```
<promise>COMPLETE</promise>
```

Otherwise, end your response normally after completing and committing ONE story.
